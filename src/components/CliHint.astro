---
interface Props {
  command: string;
}
const { command } = Astro.props;
const fullCommand = `grimoire ${command}`;
---
<div class="cli-hint">
  <code class="cli-primary">{fullCommand}</code>
  <button class="copy-btn" data-command={fullCommand} aria-label="Copy command">
    <svg class="icon-copy" width="16" height="16" viewBox="0 0 16 16" fill="none">
      <rect x="5" y="5" width="9" height="9" rx="1.5" stroke="currentColor" stroke-width="1.5"/>
      <path d="M11 3H3.5A1.5 1.5 0 002 4.5V11" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
    </svg>
    <svg class="icon-check" width="16" height="16" viewBox="0 0 16 16" fill="none" style="display:none">
      <path d="M3 8.5L6.5 12L13 4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
    </svg>
  </button>
</div>

<script>
  document.querySelectorAll('.copy-btn').forEach((btn) => {
    btn.addEventListener('click', async (e) => {
      e.preventDefault();
      const command = (btn as HTMLElement).dataset.command;
      if (!command) return;
      await navigator.clipboard.writeText(command);
      const copyIcon = btn.querySelector('.icon-copy') as HTMLElement;
      const checkIcon = btn.querySelector('.icon-check') as HTMLElement;
      copyIcon.style.display = 'none';
      checkIcon.style.display = 'block';
      setTimeout(() => {
        copyIcon.style.display = 'block';
        checkIcon.style.display = 'none';
      }, 1500);
    });
  });
</script>
